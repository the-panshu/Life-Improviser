/*! (c) Copyright 2007-2011 Xoron GmbH */
"use strict";var color_picker={};(function(){var d=360;var q=100;var s=100;var b=165;var t=166;var c=4;var u=2;var w="0084ffff";var g=1;var z;var f;var A;var n;color_picker.initialize=function(){B();color_picker.set_hex_color(w);jQuery("#sv_box").on("mousedown",v);jQuery("#hue_form").on("mousedown",m);n=jQuery("#plugin")};color_picker.set_hex_color=function(E){var D=l(E);z=y(D);C();image_editor.set_transparency(D[3])};color_picker.color_popup=function(){var E=window.prompt("Color in hex format:",o(z));var D=/^[0-9a-f]{6}$/i;if(D.test(E)){E+="ff";color_picker.set_hex_color(E)}};function v(D){return e("saturation_value_slider",D)}function m(D){return e("hue_slider",D)}function B(){var E="";for(var D=b;D>=0;D--){E+='<div style="BACKGROUND: #'+o([Math.round((360/b)*D),100,100])+';"><br /></div>'}jQuery("#hue_box").html(E)}function k(F,E,G){var D=Math.round((G/E)*F);D=h(D,0,F);return(D)}function h(D,E,F){if(D>F){return(F)}else{if(D<E){return(E)}}return(D)}function r(F){var D=Math.round(z[1]/q*t);var G=Math.round(t-z[2]/s*t);var E=Math.round(b-z[0]/d*b);jQuery("#saturation_value_slider").css("left",(D-c)+"px");jQuery("#saturation_value_slider").css("top",(G-c)+"px");jQuery("#hue_slider").css("top",(E-u-5)+"px")}function x(D){j(D.data.which_slider,D.pageX,D.pageY);return(false)}function j(G,J,I){if(!g){var E=J-f;var F=I-A;if(G==="saturation_value_slider"){var K=h(E,0,t);var D=h(F,0,t);z[1]=k(q,t,K);z[2]=s-k(s,t,D);C()}else{if(G==="hue_slider"){var H=h(F,0,b);z[0]=d-k(d,b,H);C()}}}}function e(F,E){if(g){g=0;var D=n.offset();f=D.left+10;A=D.top+22;jQuery(document).on("mousemove",{which_slider:F},x);jQuery(document).on("mouseup",function(){g=1;jQuery(document).off("mousemove",x);jQuery(document).off("mouseup",x)});j(F,E.pageX,E.pageY)}image_editor.pen_selected();return(false)}function C(){jQuery("#sv_box").css("backgroundColor","#"+o([z[0],100,100]));r(z);var D=o(z);jQuery("#color_hex_string").html(D);jQuery("#current_color_box").css("background","#"+D);jQuery("#big_current_color_box").css("background","#"+D);image_editor.change_last_used_colors();return(D)}function p(D){D=Math.round(Math.min(Math.max(0,D),255));return("0123456789ABCDEF".charAt((D-D%16)/16)+"0123456789ABCDEF".charAt(D%16))}function a(D){return(p(D[0])+p(D[1])+p(D[2]))}function l(F){var H=parseInt(F.charAt(0)+F.charAt(1),16);var G=parseInt(F.charAt(2)+F.charAt(3),16);var D=parseInt(F.charAt(4)+F.charAt(5),16);var E=parseInt(F.charAt(6)+F.charAt(7),16);return([H,G,D,E])}function o(D){return(a(i(D)))}function i(M){var L;var O;var E;var N=M[0]/360;var K=M[1]/100;var J=M[2]/100;if(K>0){if(N>=1){N=0}N=6*N;var P=N-Math.floor(N);var I=Math.round(255*J*(1-K));E=Math.round(255*J*(1-(K*P)));var D=Math.round(255*J*(1-(K*(1-P))));J=Math.round(255*J);switch(Math.floor(N)){case 0:L=J;O=D;E=I;break;case 1:L=E;O=J;E=I;break;case 2:L=I;O=J;E=D;break;case 3:L=I;O=E;E=J;break;case 4:L=D;O=I;E=J;break;case 5:L=J;O=I;E=E;break}return([L?L:0,O?O:0,E?E:0])}else{return([(J=Math.round(J*255)),J,J])}}function y(N){var L=(N[0]/255);var D=(N[1]/255);var G=(N[2]/255);var M=Math.min(L,D,G);var R=Math.max(L,D,G);var O=R-M;var E=R;var Q;var I;if(O===0){var K=y(l(w));Q=K[0]/d;I=0}else{I=O/R;var P=(((R-L)/6)+(O/2))/O;var F=(((R-D)/6)+(O/2))/O;var J=(((R-G)/6)+(O/2))/O;if(L===R){Q=J-F}else{if(D===R){Q=(1/3)+P-J}else{if(G===R){Q=(2/3)+F-P}}}if(Q<0){Q+=1}if(Q>1){Q-=1}}return([Q*d,I*q,E*s])}}());